import unittest
import sys
sys.path.append('../')
import vulnerability

class TestVulnerability(unittest.TestCase):
    """Test Class for Vulnerability"""

    def test_cve_init(self):
        vuln = vulnerability.CVE('CVE-2019-11007')
        self.assertEqual(vuln.vulnerability_id, 'CVE-2019-11007')
        self.assertEqual(vuln.type, 'cve')
        vuln = vulnerability.CVE('cve-2019-1010', ['graphicsmagick', 'Imagemagick'])
        self.assertEqual(vuln.packages, ['graphicsmagick', 'Imagemagick'])
        self.assertEqual(vuln.type, 'cve')
    
    def test_create_function(self):
        vuln = vulnerability.create_vulnerability('CVE-2018-20406', ['python'])
        self.assertEqual(vuln.vulnerability_id, 'CVE-2018-20406')
        self.assertEqual(vuln.packages, ['python'])
        vuln = vulnerability.create_vulnerability('TALOS-2018-20406', ['python'])
        self.assertEqual(vuln, None)


if __name__ == '__main__':
    unittest.main()
