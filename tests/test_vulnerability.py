from collections import deque
import unittest
import patchfinder.context as context

class TestVulnerability(unittest.TestCase):
    """Test Class for Vulnerability"""

    def test_cve_init(self):
        vuln = context.CVE('CVE-2019-11007')
        self.assertEqual(vuln.vuln_id, 'CVE-2019-11007')
        vuln = context.CVE('cve-2019-1010', {'upstream': ['graphicsmagick', \
                                                          'Imagemagick']})
        self.assertEqual(vuln.packages, {'upstream': ['graphicsmagick', \
                                                      'Imagemagick']})

    def test_create_vuln(self):
        vuln = context.create_vuln('CVE-2018-20406', {'upstream': ['python']})
        self.assertEqual(vuln.vuln_id, 'CVE-2018-20406')
        self.assertEqual(vuln.packages, {'upstream': ['python']})
        vuln = context.create_vuln('TALOS-2018-20406', {'upstream': ['python']})
        self.assertEqual(vuln, None)


if __name__ == '__main__':
    unittest.main()
