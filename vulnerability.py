import re

class Vulnerability(object):
    """Base class for vulnerabilities"""

    def __init__(self, vulnerability_id, packages=None):
        self.vulnerability_id = vulnerability_id
        self.patches = []
        self.type = 'none'
        if packages:
            self.packages = packages


class CVE(Vulnerability):
    """Subclass for CVE"""

    def __init__(self, vulnerability_id, packages=None):
        super(CVE, self).__init__(vulnerability_id, packages)
        self.type = 'cve'


def create_vulnerability(vulnerability_id, packages=None):
    if re.match(r'^CVE\-\d+\-\d+$', vulnerability_id, re.I):
        return CVE(vulnerability_id, packages)
    return None
